{% load staticfiles %}
{% block main_content %}
	<div id="main" style="width: 100%;">
		<div class="card">
			<div class="card-header header-elements-inline">
				<h5 class="card-title">BlogPost List</h5>
				<div class="header-elements">
					<div class="list-icons">
						<a class="list-icons-item" data-action="collapse"></a>
						<a class="list-icons-item" data-action="reload"></a>
						<a class="list-icons-item" data-action="remove"></a>
					</div>
				</div>
			</div>

			<div class="card-body">
				<p>
					<button type="button" class="btn btn-outline-primary btn-sm" style="float: right;"
							data-toggle="modal" data-target=".post_add_modal">
						<i class="icon-plus3 mr-3 icon-1x"></i>
						Add BlogPost
					</button>
				</p>
			</div>

			<div id="DataTables_Table_0_wrapper" class="dataTables_wrapper no-footer">
				<div class="datatable-header">
					<div id="DataTables_Table_0_filter" class="dataTables_filter">
						<label>
								<span>Filter:
								</span>
							<input type="search" class="" placeholder="Type to filter..."
								   aria-controls="DataTables_Table_0">
						</label>
					</div>
					<div class="dataTables_length" id="DataTables_Table_0_length">
						<label>
							<span>Show:</span>
							<select name="DataTables_Table_0_length" aria-controls="DataTables_Table_0"
									class="select2-hidden-accessible" tabindex="-1" aria-hidden="true">
								<option value="10">10</option>
								<option value="25">25</option>
								<option value="50">50</option>
								<option value="100">100</option>
							</select>
							<span class="select2 select2-container select2-container--default" dir="ltr"
								  style="width: auto;">
										<span class="selection"><span
												class="select2-selection select2-selection--single" role="combobox"
												aria-haspopup="true" aria-expanded="false" tabindex="0"
												aria-labelledby="select2-DataTables_Table_0_length-7n-container">
											<span class="select2-selection__rendered"
												  id="select2-DataTables_Table_0_length-7n-container"
												  title="10">10</span>
											<span class="select2-selection__arrow" role="presentation"><b
													role="presentation"></b></span></span></span>
										<span class="dropdown-wrapper" aria-hidden="true"></span>
									</span>
						</label>
					</div>
				</div>
				<div class="datatable-scroll">
					<table class="table datatable-basic dataTable no-footer" id="DataTables_Table_0" role="grid"
						   aria-describedby="DataTables_Table_0_info">
						<thead>
						<tr role="row">
							<th class="sorting_asc" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1"
								colspan="1" aria-sort="ascending"
								aria-label="First Name: activate to sort column descending">ID
							</th>
							<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
								aria-label="Last Name: activate to sort column ascending">Title
							</th>
							<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
								aria-label="Last Name: activate to sort column ascending">Content
							</th>
							<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
								aria-label="Last Name: activate to sort column ascending">Image
							</th>
							<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
								aria-label="Last Name: activate to sort column ascending">Category
							</th>
							<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
								aria-label="Job Title: activate to sort column ascending">Added Date
							</th>
							<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
								aria-label="Status: activate to sort column ascending">IsActive
							</th>
							<th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
								style="width: 100px;">Actions
							</th>
						</tr>
						</thead>
						<tbody>
						{% for blog_post in blog_post_list %}
							<tr role="row" class="odd">
								<td class="sorting_1">{{ blog_post.id }}</td>
								<td>{{ blog_post.title }}</td>
								<td>{{ blog_post.content }}</td>
								<td>{{ blog_post.image }}</td>
								<td>{{ blog_post.category.category_name }}</td>
								<td>{{ blog_post.added_date }}</td>
								<td>
									{% if blog_post.is_active == 0 %}
										<span class="badge badge-danger">{{ blog_post.is_active }}</span>
									{% else %}
										<span class="badge badge-success">{{ blog_post.is_active }}</span>
									{% endif %}
								</td>
								<td class="text-center">
									<div class="list-icons">
										<div class="dropdown">
											<a href="#" class="list-icons-item" data-toggle="dropdown">
												<i class="icon-menu9"></i>
											</a>

											<div class="dropdown-menu dropdown-menu-right">
												<a href="#" class="dropdown-item"><i class="icon-pen6 mr-3 icon-1x"></i>
													Update</a>
												<a href="#" class="dropdown-item"><i
														class="icon-cross3 mr-3 icon-1x"></i> Delete</a>
											</div>
										</div>
									</div>
								</td>
							</tr>
						{% endfor %}
						<div class="modal fade post_add_modal" tabindex="-1">
							<div class="modal-dialog modal-md">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Add BlogPost</h5>
										<button type="button" class="close" data-dismiss="modal">&times;</button>
									</div>

									<div class="modal-body">
										<div class="form-group">
											<div class="row">
												<div class="col-sm-6">
													<label class="ml-sm-2">Title</label>
													<input type="text" placeholder="Title"
														   class="form-control"
														   name="title"
														   id="title"
														   required>
												</div>
												<div class="col-sm-6">
													<label class="ml-sm-2">Content</label>
													<input type="text" placeholder="Title"
														   class="form-control"
														   name="title"
														   id="title"
														   required>
												</div>
												<div class="col-sm-6">
													<label class="ml-sm-2">Category</label>
													<div class="dropdown">
														<button class="btn btn-secondary dropdown-toggle" type="button"
																id="dropdownMenuButton" data-toggle="dropdown"
																aria-haspopup="true" aria-expanded="false">
																 {{ category_name }}
														</button>
														<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
															{% for category in category_list %}
																<a class="dropdown-item" href="#" id="category">{{ category.category_name }}</a>
															{% endfor %}
														</div>
													</div>
												</div>
											</div>
										</div>

										<div class="modal-footer">
											{% csrf_token %}
											<a class="btn btn-primary bg-400 ml-sm-2 mb-sm-0" id="post_add_button"
											   data-dismiss="modal">
												Save
											</a>
											<button class="btn bg-light" data-dismiss="modal">
												Cancel
											</button>
											<script type="text/javascript">
												$('#post_add_button').click(function (e) {
													e.preventDefault();
													e.stopImmediatePropagation();
													var csrftoken = $("[name=csrfmiddlewaretoken]").val();
													var title = $("#title").val();
													var content = $("#content").val();
													var category = $("#category").val();
													$.ajax
													({
														url: '/blog-post/add/',
														data: {
															'csrfmiddlewaretoken': csrftoken,
															'title': title,
															'content': content,
															'category': category
														},
														type: 'post',
														success: function (result) {
															$('#main').html(result);
															$('.category_add_modal').remove();
															$('.modal-backdrop').remove();
															$('body').removeClass("modal-open");

														}
													});
												});
											</script>
										</div>
									</div>
								</div>
							</div>
						</div>
						</tbody>
					</table>
				</div>
				<div class="datatable-footer">
					<div class="dataTables_info" id="DataTables_Table_0_info" role="status" aria-live="polite">Showing 1
						to 10 of 15 entries
					</div>
					<div class="dataTables_paginate paging_simple_numbers" id="DataTables_Table_0_paginate"><a
							class="paginate_button previous disabled" aria-controls="DataTables_Table_0" data-dt-idx="0"
							tabindex="0" id="DataTables_Table_0_previous">←</a><span>
								<a class="paginate_button current" aria-controls="DataTables_Table_0" data-dt-idx="1"
								   tabindex="0">1</a><a class="paginate_button " aria-controls="DataTables_Table_0"
														data-dt-idx="2" tabindex="0">2</a></span><a
							class="paginate_button next" aria-controls="DataTables_Table_0" data-dt-idx="3" tabindex="0"
							id="DataTables_Table_0_next">→</a>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

